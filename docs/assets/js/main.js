"use strict";const input=document.querySelector(".js-input"),button=document.querySelector(".js-button"),container=document.querySelector(".js-container"),containerFav=document.querySelector(".js-containerFav");let series=[],favorites=[];function setLocalStorage(){console.log("setLocalStorage",favorites),localStorage.setItem("favorites",JSON.stringify(favorites))}function getLocalStorage(){console.log("comprobando");const e=JSON.parse(localStorage.getItem("favorites"));null!==e&&(console.log("tengo datos"),favorites=e,paintFavSeries(),listenSeries())}function getServerData(e){let s=input.value;e.preventDefault(),fetch(`http://api.tvmaze.com/search/shows?q=${s}`).then(function(e){return e.json()}).then(function(e){series=e,paintSeries(),listenSeries()}).catch(function(e){console.log("Error al traer los datos del servidor",e)})}function paintSeries(){let e="";for(let s=0;s<series.length;s++){let t=!1;for(const e of favorites)series[s].show.id===e.show.id&&(t=!0);t?(e+=`<li class='container__list__item--fav js-card'index='${series[s].show.indexOf}'id='${series[s].show.id}'>`,null===series[s].show.image?e+='<img class="item__img"src="./assets/images/tvPlaceholder.png"/>':e+=`<img class='item__img'src='${series[s].show.image.medium}'/>`,e+=`<h3>${series[s].show.name}</h3>`,e+="</li>"):(e+=`<li class='container__list__item js-card'index='${series[s].show.indexOf}'id='${series[s].show.id}'>`,null===series[s].show.image?e+='<img class="item__img"src="./assets/images/tvPlaceholder.png"/>':e+=`<img class='item__img'src='${series[s].show.image.medium}'/>`,e+=`<h3>${series[s].show.name}</h3>`,e+="</li>")}container.innerHTML=e}function toggleFavorites(e){console.log(e.currentTarget.id);const s=parseInt(e.currentTarget.id);let t=-1;for(let e=0;e<favorites.length;e++)s===favorites[e].show.id&&(t=e);if(-1===t)for(let e=0;e<series.length;e++)s===series[e].show.id&&favorites.push(series[e]);else favorites.splice(t,1);console.log(favorites),paintFavSeries(),paintSeries(),listenSeries(),setLocalStorage()}function paintFavSeries(){let e="";for(let s=0;s<favorites.length;s++)e+=`<li class='container__list__item--fav js-card'id='${favorites[s].show.id}'>`,null===favorites[s].show.image?e+='<img class="item__img"src="./assets/images/tvPlaceholder.png"/>':e+=`<img class='item__img--fav'src='${favorites[s].show.image.medium}'/>`,e+=`<h3 class="favTitle"><i class="fas fa-heart"></i>${favorites[s].show.name}</h3>`,e+="</li>";containerFav.innerHTML=e}function listenSeries(){const e=document.querySelectorAll(".js-card");for(const s of e)s.addEventListener("click",toggleFavorites)}button.addEventListener("click",getServerData),getLocalStorage();